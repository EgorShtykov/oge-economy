/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ğŸ® Ğ•Ğ”Ğ˜ĞĞĞ¯ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ ĞŸĞĞĞ©Ğ Ğ•ĞĞ˜Ğ¯ Ğ£Ğ§Ğ•ĞĞ˜ĞšĞĞ’ ĞĞ“Ğ­ ĞŸĞ ĞœĞĞ¢Ğ•ĞœĞĞ¢Ğ˜ĞšĞ•
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * 
 * Ğ’ĞµÑ€ÑĞ¸Ñ: 1.0.0
 * ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¸Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ğ²Ğ°Ğ»ÑÑ‚Ñ‹, Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ° Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
 * 
 * Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸:
 * - ĞĞ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ½ĞµÑ‚ Ğ·Ğ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ñ‹
 * - ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ° Ğ¿Ğ¾ Ğ²ÑĞµĞ¼ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸ÑĞ¼
 * - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² ÑƒÑ‡Ğ¸Ñ‚ĞµĞ»Ñ Ñ‡ĞµÑ€ĞµĞ· Google Forms
 * - Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ²Ğ°Ğ»ÑÑ‚Ñ‹ across all sites
 * - Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ¸ ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ¹
 */

(function(global) {
    'use strict';

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ĞšĞĞĞ¤Ğ˜Ğ“Ğ£Ğ ĞĞ¦Ğ˜Ğ¯
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const CONFIG = {
        // ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ²Ğ°Ğ»ÑÑ‚Ñ‹
        CURRENCY_NAME: 'Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¼Ğ¾Ğ½ĞµÑ‚',
        CURRENCY_ICON: 'ğŸª™',
        
        // ĞĞ°Ğ³Ñ€Ğ°Ğ´Ñ‹ Ğ·Ğ° Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
        REWARDS: {
            EASY: 5,      // Ğ›Ñ‘Ğ³ĞºĞ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
            MEDIUM: 10,   // Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
            HARD: 15,     // Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
            BONUS: 20     // Ğ‘Ğ¾Ğ½ÑƒÑ Ğ·Ğ° ÑĞµÑ€Ğ¸Ñ
        },
        
        // ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Google Forms (Ğ—ĞĞŸĞĞ›ĞĞ˜Ğ¢Ğ• ĞŸĞ Ğ˜ ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ•)
        GOOGLE_FORM_URL: 'https://docs.google.com/forms/d/e/1FAIpQLSc23XeX8M6Cbku_2LYz7wvlW0RFQ4h-GlV18k_5ImJpmNcMmQ/formResponse',
        FORM_FIELDS: {
            name: 'entry.853692191',      // Ğ˜Ğ¼Ñ ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ°
            task: 'entry.145846187',      // ĞĞ¾Ğ¼ĞµÑ€ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
            result: 'entry.737084295',    // Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
            coins: 'entry.123456789',     // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚ (Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¿Ğ¾Ğ»Ğµ)
            timestamp: 'entry.941158920'  // Ğ’Ñ€ĞµĞ¼Ñ
        },
        
        // ĞšĞ»ÑÑ‡Ğ¸ localStorage
        STORAGE_KEYS: {
            BALANCE: 'oge_reward_balance',
            PROGRESS: 'oge_reward_progress',
            STUDENT_NAME: 'oge_reward_student_name',
            ACHIEVEMENTS: 'oge_reward_achievements',
            STATS: 'oge_reward_stats',
            LAST_VISIT: 'oge_reward_last_visit'
        }
    };

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ĞšĞ›ĞĞ¡Ğ¡ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ« ĞŸĞĞĞ©Ğ Ğ•ĞĞ˜Ğ¯
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    class RewardSystem {
        constructor() {
            this.initialized = false;
            this.currentTaskId = null;
            this.solvedTasks = new Set();
            this.init();
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Ğ˜ĞĞ˜Ğ¦Ğ˜ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        init() {
            if (this.initialized) return;
            
            // Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
            this.loadData();
            
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ĞµĞ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ
            this.checkDailyBonus();
            
            this.initialized = true;
            console.log('ğŸ® RewardSystem Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°');
        }

        loadData() {
            // Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ
            this.balance = parseInt(localStorage.getItem(CONFIG.STORAGE_KEYS.BALANCE)) || 0;
            
            // ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¿Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸ÑĞ¼
            const savedProgress = localStorage.getItem(CONFIG.STORAGE_KEYS.PROGRESS);
            this.progress = savedProgress ? JSON.parse(savedProgress) : {};
            
            // Ğ˜Ğ¼Ñ ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ°
            this.studentName = localStorage.getItem(CONFIG.STORAGE_KEYS.STUDENT_NAME) || '';
            
            // Ğ”Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ
            const savedAchievements = localStorage.getItem(CONFIG.STORAGE_KEYS.ACHIEVEMENTS);
            this.achievements = savedAchievements ? JSON.parse(savedAchievements) : [];
            
            // Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
            const savedStats = localStorage.getItem(CONFIG.STORAGE_KEYS.STATS);
            this.stats = savedStats ? JSON.parse(savedStats) : {
                totalSolved: 0,
                correctAnswers: 0,
                wrongAnswers: 0,
                streak: 0,
                maxStreak: 0,
                tasksByType: {}
            };
        }

        saveData() {
            localStorage.setItem(CONFIG.STORAGE_KEYS.BALANCE, this.balance);
            localStorage.setItem(CONFIG.STORAGE_KEYS.PROGRESS, JSON.stringify(this.progress));
            localStorage.setItem(CONFIG.STORAGE_KEYS.STUDENT_NAME, this.studentName);
            localStorage.setItem(CONFIG.STORAGE_KEYS.ACHIEVEMENTS, JSON.stringify(this.achievements));
            localStorage.setItem(CONFIG.STORAGE_KEYS.STATS, JSON.stringify(this.stats));
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Ğ£ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ• Ğ’ĞĞ›Ğ®Ğ¢ĞĞ™
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ
         */
        getBalance() {
            return this.balance;
        }

        /**
         * ĞĞ°Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ½ĞµÑ‚Ñ‹
         * @param {number} amount - ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚
         * @param {string} reason - ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ° Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ
         */
        addCoins(amount, reason = '') {
            this.balance += amount;
            this.saveData();
            
            // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
            this.showCoinNotification(amount, reason);
            
            // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ°
            this.updateBalanceDisplay();
            
            console.log(`ğŸ’° +${amount} Ğ¼Ğ¾Ğ½ĞµÑ‚ (${reason}). Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${this.balance}`);
            return this.balance;
        }

        /**
         * Ğ¡Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ¼Ğ¾Ğ½ĞµÑ‚Ñ‹
         * @param {number} amount - ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚
         * @param {string} reason - ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ° ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ
         * @returns {boolean} - Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ»Ğ¸ ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
         */
        spendCoins(amount, reason = '') {
            if (this.balance < amount) {
                this.showNotification('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚! ğŸ˜¢', 'error');
                return false;
            }
            
            this.balance -= amount;
            this.saveData();
            this.updateBalanceDisplay();
            
            this.showNotification(`-${amount} ${CONFIG.CURRENCY_NAME} (${reason})`, 'success');
            console.log(`ğŸ’¸ -${amount} Ğ¼Ğ¾Ğ½ĞµÑ‚ (${reason}). Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${this.balance}`);
            return true;
        }

        /**
         * ĞĞ°Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ½Ğ°Ğ³Ñ€Ğ°Ğ´Ñƒ Ğ·Ğ° Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
         * @param {string} difficulty - Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ: 'easy', 'medium', 'hard'
         * @param {string} taskId - ID Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
         */
        rewardForTask(difficulty = 'easy', taskId = '') {
            const reward = CONFIG.REWARDS[difficulty.toUpperCase()] || CONFIG.REWARDS.EASY;
            
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ½Ğµ Ñ€ĞµÑˆĞ°Ğ»Ğ¾ÑÑŒ Ğ»Ğ¸ ÑƒĞ¶Ğµ ÑÑ‚Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
            if (taskId && this.isTaskSolved(taskId)) {
                return 0; // Ğ£Ğ¶Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¾, Ğ½Ğµ Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼
            }
            
            // ĞĞ°Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ¼Ğ¾Ğ½ĞµÑ‚Ñ‹
            this.addCoins(reward, `Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ ${difficulty}`);
            
            // ĞÑ‚Ğ¼ĞµÑ‡Ğ°ĞµĞ¼ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ°Ğº Ñ€ĞµÑˆÑ‘Ğ½Ğ½Ğ¾Ğµ
            if (taskId) {
                this.markTaskSolved(taskId, reward);
            }
            
            // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
            this.stats.correctAnswers++;
            this.stats.streak++;
            if (this.stats.streak > this.stats.maxStreak) {
                this.stats.maxStreak = this.stats.streak;
            }
            
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ±Ğ¾Ğ½ÑƒÑ Ğ·Ğ° ÑĞµÑ€Ğ¸Ñ
            if (this.stats.streak >= 5) {
                this.addCoins(CONFIG.REWARDS.BONUS, 'Ğ‘Ğ¾Ğ½ÑƒÑ Ğ·Ğ° ÑĞµÑ€Ğ¸Ñ Ğ¸Ğ· 5! ğŸ”¥');
                this.stats.streak = 0; // Ğ¡Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ ÑĞµÑ€Ğ¸Ñ
            }
            
            this.saveData();
            return reward;
        }

        /**
         * ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚
         */
        penalizeWrongAnswer() {
            this.stats.wrongAnswers++;
            this.stats.streak = 0; // Ğ¡Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ ÑĞµÑ€Ğ¸Ñ
            this.saveData();
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // ĞĞ¢Ğ¡Ğ›Ğ•Ğ–Ğ˜Ğ’ĞĞĞ˜Ğ• ĞŸĞ ĞĞ“Ğ Ğ•Ğ¡Ğ¡Ğ
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * ĞÑ‚Ğ¼ĞµÑ‚Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ°Ğº Ñ€ĞµÑˆÑ‘Ğ½Ğ½Ğ¾Ğµ
         * @param {string} taskId - ID Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: 'task15_1')
         * @param {number} coins - ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚
         */
        markTaskSolved(taskId, coins = 0) {
            if (!this.progress[taskId]) {
                this.progress[taskId] = {
                    solved: true,
                    firstSolved: new Date().toISOString(),
                    coinsEarned: coins,
                    attempts: 1
                };
                this.stats.totalSolved++;
                this.solvedTasks.add(taskId);
                this.saveData();
            } else {
                this.progress[taskId].attempts++;
                this.saveData();
            }
        }

        /**
         * ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ñ€ĞµÑˆĞµĞ½Ğ¾ Ğ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
         * @param {string} taskId - ID Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
         */
        isTaskSolved(taskId) {
            return this.progress[taskId] && this.progress[taskId].solved;
        }

        /**
         * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ñ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ
         * @param {number} totalTasks - ĞĞ±Ñ‰ĞµĞµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹
         */
        getProgress(totalTasks = 0) {
            const solved = Object.keys(this.progress).filter(k => this.progress[k].solved).length;
            const percent = totalTasks > 0 ? Math.round((solved / totalTasks) * 100) : 0;
            
            return {
                solved,
                total: totalTasks,
                percent,
                balance: this.balance
            };
        }

        /**
         * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¿Ğ¾ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¼Ñƒ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ ĞĞ“Ğ­
         * @param {string} taskType - Ğ¢Ğ¸Ğ¿ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ (15, 16, 17, 18, 19)
         */
        getProgressByTaskType(taskType) {
            const tasks = Object.keys(this.progress).filter(k => k.startsWith(`task${taskType}_`));
            const solved = tasks.filter(k => this.progress[k].solved).length;
            return { solved, total: tasks.length };
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Ğ£ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ• Ğ˜ĞœĞ•ĞĞ•Ğœ Ğ£Ğ§Ğ•ĞĞ˜ĞšĞ
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ/Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ¼Ñ ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ°
         */
        setStudentName(name) {
            if (name && name.trim()) {
                this.studentName = name.trim();
                localStorage.setItem(CONFIG.STORAGE_KEYS.STUDENT_NAME, this.studentName);
                this.updateStudentNameDisplay();
                return true;
            }
            return false;
        }

        /**
         * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ¼Ñ ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ°
         */
        getStudentName() {
            return this.studentName;
        }

        /**
         * Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ¸Ğ¼Ñ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸
         */
        askStudentName() {
            if (!this.studentName) {
                const name = prompt('ğŸ‘‹ ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! Ğ’Ğ²ĞµĞ´Ğ¸ ÑĞ²Ğ¾Ñ‘ Ğ¸Ğ¼Ñ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ñ Ğ¼Ğ¾Ğ³ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ²Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ:');
                if (name) {
                    this.setStudentName(name);
                    this.showNotification(`ĞŸÑ€Ğ¸Ğ²ĞµÑ‚, ${name}! ğŸ‰`, 'success');
                }
            }
            return this.studentName;
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // ĞĞ¢ĞŸĞ ĞĞ’ĞšĞ Ğ’ GOOGLE FORMS
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ² Google Forms
         * @param {Object} data - Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸
         */
        async submitToGoogleForms(data = {}) {
            if (!this.studentName) {
                this.askStudentName();
                return false;
            }

            const formData = new FormData();
            formData.append(CONFIG.FORM_FIELDS.name, this.studentName);
            formData.append(CONFIG.FORM_FIELDS.task, data.task || 'ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¾');
            formData.append(CONFIG.FORM_FIELDS.result, data.result || 'Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾');
            formData.append(CONFIG.FORM_FIELDS.coins, data.coins || 0);
            formData.append(CONFIG.FORM_FIELDS.timestamp, new Date().toLocaleString('ru-RU'));

            try {
                await fetch(CONFIG.GOOGLE_FORM_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: formData
                });
                
                this.showNotification('âœ… Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½ ÑƒÑ‡Ğ¸Ñ‚ĞµĞ»Ñ!', 'success');
                return true;
            } catch (error) {
                console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸:', error);
                this.showNotification('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸', 'error');
                return false;
            }
        }

        /**
         * ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
         */
        async submitAllResults() {
            if (!this.studentName) {
                this.askStudentName();
                return;
            }

            const solvedTasksList = Object.keys(this.progress).filter(k => this.progress[k].solved);
            
            if (solvedTasksList.length === 0) {
                this.showNotification('Ğ ĞµÑˆĞ¸ Ñ…Ğ¾Ñ‚Ñ Ğ±Ñ‹ Ğ¾Ğ´Ğ½Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ! ğŸ“š', 'warning');
                return;
            }

            const btn = document.getElementById('send-results-btn');
            if (btn) {
                btn.textContent = 'â³ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ°...';
                btn.disabled = true;
            }

            // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞºĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
            const promises = solvedTasksList.map(taskId => {
                return this.submitToGoogleForms({
                    task: taskId,
                    result: 'âœ“ Ğ’ĞµÑ€Ğ½Ğ¾',
                    coins: this.progress[taskId].coinsEarned || 0
                });
            });

            await Promise.all(promises);
            
            if (btn) {
                btn.textContent = 'âœ… ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾!';
                btn.style.background = '#4caf50';
                setTimeout(() => {
                    btn.textContent = 'ğŸ“¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑƒÑ‡Ğ¸Ñ‚ĞµĞ»Ñ';
                    btn.disabled = false;
                    btn.style.background = '';
                }, 3000);
            }
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Ğ‘ĞĞĞ£Ğ¡Ğ« Ğ˜ Ğ”ĞĞ¡Ğ¢Ğ˜Ğ–Ğ•ĞĞ˜Ğ¯
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ĞµĞ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ
         */
        checkDailyBonus() {
            const lastVisit = localStorage.getItem(CONFIG.STORAGE_KEYS.LAST_VISIT);
            const today = new Date().toDateString();
            
            if (lastVisit !== today) {
                // ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ - Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ±Ğ¾Ğ½ÑƒÑ
                if (lastVisit) {
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    if (lastVisit === yesterday.toDateString()) {
                        // ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾ÑĞµÑ‰ĞµĞ½Ğ¸Ğµ
                        this.addCoins(10, 'Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ! ğŸ“…');
                    } else {
                        // ĞŸÑ€Ğ¾Ğ¿ÑƒÑ‰ĞµĞ½ Ğ´ĞµĞ½ÑŒ
                        this.addCoins(5, 'Ğ¡ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸ĞµĞ¼! ğŸ‘‹');
                    }
                } else {
                    // ĞŸĞµÑ€Ğ²Ğ¾Ğµ Ğ¿Ğ¾ÑĞµÑ‰ĞµĞ½Ğ¸Ğµ
                    this.addCoins(20, 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ! ğŸ');
                }
                
                localStorage.setItem(CONFIG.STORAGE_KEYS.LAST_VISIT, today);
            }
        }

        /**
         * ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ
         */
        checkAchievements() {
            const achievements = [];
            
            if (this.stats.totalSolved >= 1) achievements.push('first_step');
            if (this.stats.totalSolved >= 10) achievements.push('solver_10');
            if (this.stats.totalSolved >= 50) achievements.push('solver_50');
            if (this.stats.totalSolved >= 100) achievements.push('solver_100');
            if (this.stats.maxStreak >= 5) achievements.push('streak_5');
            if (this.stats.maxStreak >= 10) achievements.push('streak_10');
            if (this.balance >= 100) achievements.push('rich_100');
            if (this.balance >= 500) achievements.push('rich_500');
            
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ
            achievements.forEach(id => {
                if (!this.achievements.includes(id)) {
                    this.achievements.push(id);
                    this.showAchievement(id);
                }
            });
            
            this.saveData();
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // UI Ğ˜ĞĞ¢Ğ•Ğ“Ğ ĞĞ¦Ğ˜Ğ¯
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ°
         */
        createBalanceWidget() {
            const widget = document.createElement('div');
            widget.id = 'reward-balance-widget';
            widget.innerHTML = `
                <div style="
                    position: fixed;
                    top: 80px;
                    right: 20px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 12px 20px;
                    border-radius: 25px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                    z-index: 9999;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    cursor: pointer;
                    transition: transform 0.2s;
                " onclick="window.open('index.html', '_blank')">
                    <span style="font-size: 1.2rem;">${CONFIG.CURRENCY_ICON}</span>
                    <span id="reward-balance-display">${this.balance}</span>
                </div>
            `;
            document.body.appendChild(widget);
            
            // Hover ÑÑ„Ñ„ĞµĞºÑ‚
            widget.querySelector('div').addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.05)';
            });
            widget.querySelector('div').addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        }

        /**
         * ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ°
         */
        updateBalanceDisplay() {
            const display = document.getElementById('reward-balance-display');
            if (display) {
                display.textContent = this.balance;
                // ĞĞ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ
                display.parentElement.style.animation = 'pulse 0.3s';
                setTimeout(() => {
                    display.parentElement.style.animation = '';
                }, 300);
            }
        }

        /**
         * Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ‚Ñ€ĞµĞºĞµÑ€ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ°
         * @param {number} totalTasks - ĞĞ±Ñ‰ĞµĞµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹
         */
        createProgressTracker(totalTasks) {
            const tracker = document.createElement('div');
            tracker.id = 'reward-progress-tracker';
            
            const progress = this.getProgress(totalTasks);
            
            tracker.innerHTML = `
                <div style="
                    position: fixed;
                    top: 140px;
                    right: 20px;
                    background: white;
                    padding: 15px;
                    border-radius: 12px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                    z-index: 9998;
                    min-width: 200px;
                    border: 2px solid #667eea;
                ">
                    <div style="font-weight: bold; color: #667eea; margin-bottom: 10px;">
                        ğŸ“Š ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ: <span id="progress-percent">${progress.percent}%</span>
                    </div>
                    <div style="
                        width: 100%;
                        height: 10px;
                        background: #e0e0e0;
                        border-radius: 5px;
                        overflow: hidden;
                        margin-bottom: 10px;
                    ">
                        <div id="progress-bar-fill" style="
                            height: 100%;
                            background: linear-gradient(90deg, #667eea, #764ba2);
                            width: ${progress.percent}%;
                            transition: width 0.4s ease;
                        "></div>
                    </div>
                    <div style="font-size: 0.9rem; color: #666; margin-bottom: 10px;">
                        Ğ ĞµÑˆĞµĞ½Ğ¾: <span id="solved-count">${progress.solved}</span> Ğ¸Ğ· ${totalTasks}
                    </div>
                    <div id="student-name-display" style="
                        font-size: 0.9rem;
                        color: #667eea;
                        margin: 8px 0;
                        padding: 5px;
                        background: #f0f0f0;
                        border-radius: 6px;
                        text-align: center;
                        display: ${this.studentName ? 'block' : 'none'};
                    ">
                        ğŸ‘¤ <span id="current-student-name">${this.studentName}</span>
                    </div>
                    <button id="send-results-btn" onclick="RewardSystem.submitAllResults()" style="
                        width: 100%;
                        padding: 8px;
                        background: #4caf50;
                        color: white;
                        border: none;
                        border-radius: 6px;
                        cursor: pointer;
                        font-weight: bold;
                        margin-top: 10px;
                        display: ${progress.solved > 0 ? 'block' : 'none'};
                    ">ğŸ“¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑƒÑ‡Ğ¸Ñ‚ĞµĞ»Ñ</button>
                    <div style="display: flex; gap: 8px; margin-top: 10px;">
                        <button onclick="RewardSystem.askStudentName()" style="
                            flex: 1;
                            padding: 6px;
                            background: #e3f2fd;
                            color: #1976d2;
                            border: none;
                            border-radius: 6px;
                            cursor: pointer;
                            font-size: 0.85rem;
                        ">âœï¸ Ğ˜Ğ¼Ñ</button>
                        <button onclick="RewardSystem.resetAllProgress()" style="
                            flex: 1;
                            padding: 6px;
                            background: #ffebee;
                            color: #c62828;
                            border: none;
                            border-radius: 6px;
                            cursor: pointer;
                            font-size: 0.85rem;
                        ">ğŸ—‘ï¸ Ğ¡Ğ±Ñ€Ğ¾Ñ</button>
                    </div>
                </div>
            `;
            document.body.appendChild(tracker);
        }

        /**
         * ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ñ€ĞµĞºĞµÑ€ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ°
         * @param {number} totalTasks - ĞĞ±Ñ‰ĞµĞµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹
         */
        updateProgressTracker(totalTasks) {
            const progress = this.getProgress(totalTasks);
            
            const percentEl = document.getElementById('progress-percent');
            const barEl = document.getElementById('progress-bar-fill');
            const solvedEl = document.getElementById('solved-count');
            const sendBtn = document.getElementById('send-results-btn');
            
            if (percentEl) percentEl.textContent = progress.percent + '%';
            if (barEl) barEl.style.width = progress.percent + '%';
            if (solvedEl) solvedEl.textContent = progress.solved;
            if (sendBtn) sendBtn.style.display = progress.solved > 0 ? 'block' : 'none';
        }

        /**
         * ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¸Ğ¼ĞµĞ½Ğ¸
         */
        updateStudentNameDisplay() {
            const nameDisplay = document.getElementById('student-name-display');
            const nameSpan = document.getElementById('current-student-name');
            
            if (nameDisplay && nameSpan) {
                if (this.studentName) {
                    nameSpan.textContent = this.studentName;
                    nameDisplay.style.display = 'block';
                } else {
                    nameDisplay.style.display = 'none';
                }
            }
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Ğ£Ğ’Ğ•Ğ”ĞĞœĞ›Ğ•ĞĞ˜Ğ¯
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ¼Ğ¾Ğ½ĞµÑ‚
         */
        showCoinNotification(amount, reason) {
            const notification = document.createElement('div');
            notification.innerHTML = `
                <div style="
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
                    color: #333;
                    padding: 15px 25px;
                    border-radius: 12px;
                    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.5);
                    z-index: 10000;
                    font-weight: bold;
                    font-size: 1.1rem;
                    animation: coinPopup 0.5s ease-out;
                ">
                    ğŸª™ +${amount} ${reason ? `(${reason})` : ''}
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        /**
         * ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾Ğµ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
         */
        showNotification(message, type = 'info') {
            const colors = {
                success: '#4caf50',
                error: '#f44336',
                warning: '#ff9800',
                info: '#2196f3'
            };
            
            const notification = document.createElement('div');
            notification.innerHTML = `
                <div style="
                    position: fixed;
                    bottom: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: ${colors[type] || colors.info};
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                    z-index: 10000;
                    font-weight: 500;
                ">
                    ${message}
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        /**
         * ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ
         */
        showAchievement(achievementId) {
            const achievements = {
                'first_step': { icon: 'ğŸ¯', name: 'ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ ÑˆĞ°Ğ³', desc: 'Ğ ĞµÑˆĞ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ' },
                'solver_10': { icon: 'ğŸ“š', name: 'Ğ£Ñ‡ĞµĞ½Ğ¸Ğº', desc: 'Ğ ĞµÑˆĞ¸ 10 Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹' },
                'solver_50': { icon: 'ğŸ“', name: 'Ğ­ĞºÑĞ¿ĞµÑ€Ñ‚', desc: 'Ğ ĞµÑˆĞ¸ 50 Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹' },
                'solver_100': { icon: 'ğŸ†', name: 'ĞœĞ°ÑÑ‚ĞµÑ€ ĞĞ“Ğ­', desc: 'Ğ ĞµÑˆĞ¸ 100 Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹' },
                'streak_5': { icon: 'ğŸ”¥', name: 'Ğ¡ĞµÑ€Ğ¸Ñ!', desc: '5 Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ¾Ğ´Ñ€ÑĞ´' },
                'streak_10': { icon: 'âš¡', name: 'Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°!', desc: '10 Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ¾Ğ´Ñ€ÑĞ´' },
                'rich_100': { icon: 'ğŸ’°', name: 'Ğ‘Ğ¾Ğ³Ğ°Ñ‡', desc: 'ĞĞ°ĞºĞ¾Ğ¿Ğ¸ 100 Ğ¼Ğ¾Ğ½ĞµÑ‚' },
                'rich_500': { icon: 'ğŸ‘‘', name: 'ĞœĞ¸Ğ»Ğ»Ğ¸Ğ¾Ğ½ĞµÑ€', desc: 'ĞĞ°ĞºĞ¾Ğ¿Ğ¸ 500 Ğ¼Ğ¾Ğ½ĞµÑ‚' }
            };
            
            const ach = achievements[achievementId];
            if (!ach) return;
            
            const popup = document.createElement('div');
            popup.innerHTML = `
                <div style="
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 30px;
                    border-radius: 20px;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
                    z-index: 10001;
                    text-align: center;
                    animation: achievementPopup 0.5s ease-out;
                ">
                    <div style="font-size: 4rem; margin-bottom: 15px;">${ach.icon}</div>
                    <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 10px;">Ğ”Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!</div>
                    <div style="font-size: 1.2rem; margin-bottom: 5px;">${ach.name}</div>
                    <div style="opacity: 0.8;">${ach.desc}</div>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        margin-top: 20px;
                        padding: 10px 20px;
                        background: white;
                        color: #667eea;
                        border: none;
                        border-radius: 8px;
                        cursor: pointer;
                        font-weight: bold;
                    ">ĞšÑ€ÑƒÑ‚Ğ¾! ğŸ‰</button>
                </div>
            `;
            document.body.appendChild(popup);
            
            // Ğ‘Ğ¾Ğ½ÑƒÑ Ğ·Ğ° Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ
            this.addCoins(25, `Ğ”Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ: ${ach.name}`);
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Ğ¡Ğ‘Ğ ĞĞ¡ Ğ˜ ĞĞ§Ğ˜Ğ¡Ğ¢ĞšĞ
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        /**
         * Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ²ĞµÑÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ
         */
        resetAllProgress() {
            const confirmed = confirm(`âš ï¸ Ğ’ĞĞ˜ĞœĞĞĞ˜Ğ•!

Ğ’Ñ‹ ÑƒĞ²ĞµÑ€ĞµĞ½Ñ‹, Ñ‡Ñ‚Ğ¾ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ÑĞ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ’Ğ•Ğ¡Ğ¬ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ?

Ğ‘ÑƒĞ´ĞµÑ‚ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¾:
â€¢ Ğ˜Ğ¼Ñ ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ°: ${this.studentName || '(Ğ½Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¾)'}
â€¢ Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${this.balance} Ğ¼Ğ¾Ğ½ĞµÑ‚
â€¢ Ğ ĞµÑˆÑ‘Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹: ${this.stats.totalSolved}
â€¢ Ğ’ÑĞµ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ

Ğ­Ñ‚Ğ¾ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ğ½ĞµĞ»ÑŒĞ·Ñ Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ!`);

            if (confirmed) {
                // ĞÑ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ localStorage
                Object.values(CONFIG.STORAGE_KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
                
                // Ğ¡Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ
                this.balance = 0;
                this.progress = {};
                this.studentName = '';
                this.achievements = [];
                this.stats = {
                    totalSolved: 0,
                    correctAnswers: 0,
                    wrongAnswers: 0,
                    streak: 0,
                    maxStreak: 0,
                    tasksByType: {}
                };
                this.solvedTasks.clear();
                
                // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ UI
                this.updateBalanceDisplay();
                this.updateStudentNameDisplay();
                
                this.showNotification('âœ… ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ ÑĞ±Ñ€Ğ¾ÑˆĞµĞ½!', 'success');
                
                // ĞŸĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ
                setTimeout(() => location.reload(), 1500);
            }
        }

        /**
         * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
         */
        getFullStats() {
            return {
                balance: this.balance,
                studentName: this.studentName,
                totalSolved: this.stats.totalSolved,
                correctAnswers: this.stats.correctAnswers,
                wrongAnswers: this.stats.wrongAnswers,
                accuracy: this.stats.correctAnswers + this.stats.wrongAnswers > 0 
                    ? Math.round((this.stats.correctAnswers / (this.stats.correctAnswers + this.stats.wrongAnswers)) * 100)
                    : 0,
                maxStreak: this.stats.maxStreak,
                achievements: this.achievements,
                progress: this.progress
            };
        }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ¡Ğ¢Ğ˜Ğ›Ğ˜ Ğ”Ğ›Ğ¯ ĞĞĞ˜ĞœĞĞ¦Ğ˜Ğ™
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const styles = document.createElement('style');
    styles.textContent = `
        @keyframes coinPopup {
            0% { transform: translateX(-50%) translateY(-50px); opacity: 0; }
            50% { transform: translateX(-50%) translateY(10px); }
            100% { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
        
        @keyframes achievementPopup {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            70% { transform: translate(-50%, -50%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… */
        @media (max-width: 768px) {
            #reward-balance-widget > div {
                top: 60px !important;
                right: 10px !important;
                padding: 8px 15px !important;
                font-size: 0.9rem !important;
            }
            
            #reward-progress-tracker > div {
                top: 110px !important;
                right: 10px !important;
                min-width: 150px !important;
                padding: 10px !important;
            }
        }
    `;
    document.head.appendChild(styles);

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞĞ“Ğ Ğ­ĞšĞ—Ğ•ĞœĞŸĞ›Ğ¯Ğ Ğ
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const rewardSystem = new RewardSystem();

    // Ğ”ĞµĞ»Ğ°ĞµĞ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğ¼ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ¾
    global.RewardSystem = rewardSystem;

    // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚Ğ¾Ğ² Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ
    document.addEventListener('DOMContentLoaded', function() {
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ°
        rewardSystem.createBalanceWidget();
        
        console.log('ğŸ® RewardSystem Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ!');
    });

})(window);
